<!DOCTYPE html>
<html>
<head>
    <title>Tesla Tracker</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>#map { height: 80vh; } body { text-align:center; }</style>
</head>
<body>
<h2>Tesla Live Tracker</h2>
<input type="text" id="trackingId" placeholder="Enter Tracking ID" value="TESLA-USA-2410-784632">
<button onclick="startTracking()">Track</button>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
let map, marker, socket;

function startTracking() {
    const trackingId = document.getElementById('trackingId').value.trim();
    if (!trackingId) return alert("Enter a tracking ID");

    if (!map) {
        map = L.map('map').setView([9.0820, 8.6753], 6);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);
        marker = L.marker([9.0820, 8.6753]).addTo(map).bindPopup(`${trackingId} Vehicle`);
        socket = io();
    }

    socket.emit('join', trackingId);
    socket.on(`locationUpdate-${trackingId}`, coords => {
        marker.setLatLng(coords);
        marker.getPopup().setContent(`${trackingId} Location: ${coords}`);
        map.panTo(coords);
    });
}
</script>
</body>
</html>
